---
import Wiki from '$components/wiki.astro'
import {
  getWikiPage,
  modifyResponseForWikiPage,
} from '$functions/wiki/getWikiPage'

let { pageRef } = Astro.params

const search = Astro.url.search || ''

if (pageRef === undefined) pageRef = 'MainPage'
else if (pageRef === 'MainPage') return Astro.redirect('/wiki' + search)
else if (pageRef === 'Ring') return Astro.redirect('/ring' + search)
else if (pageRef.startsWith('Events/'))
  return Astro.redirect(`/event/${pageRef.replace('Events/', '')}${search}`)

const wikiPage = await getWikiPage(pageRef)
modifyResponseForWikiPage(wikiPage, Astro)
---

<Wiki pageRef={pageRef} wikiPage={wikiPage} />
