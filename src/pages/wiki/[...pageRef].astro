---
import { Octokit } from '@octokit/rest'
import { Markdown } from '@contentsgarten/markdown'

import WikiLayout from '$layouts/wiki.astro'

const octokit = new Octokit({
  auth: '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',
  timeZone: 'Asia/Bangkok',
})

const { pageRef } = Astro.params

const markdownUrl = `https://raw.githubusercontent.com/creatorsgarten/wiki/main/wiki/${pageRef}.md`
const raw = await fetch(markdownUrl, { method: 'GET' })
const md = await raw.text()
---

<WikiLayout
  title={pageRef as string}
  contents={[
    {
      id: 'a',
      label: 'a',
    },
  ]}
  metadata={{
    created: {
      at: new Date(),
      by: 'owo',
    },
    edited: {
      at: new Date(),
      by: 'owo',
    },
  }}
>
  <Markdown text={md} />
</WikiLayout>
